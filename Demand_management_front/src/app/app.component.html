<!DOCTYPE html>
<html lang="es">
<body>
  <div *ngIf="authService.isAuthenticated()">

  <!-- OFFCANVAS / MENÚ LATERAL -->
  <div
    id="sidebarMenu"
    class="offcanvas offcanvas-start text-bg-light"
    tabindex="-1"
    aria-labelledby="sidebarMenuLabel"
  >
    <div class="offcanvas-header bg-success text-white">
      <h5 class="offcanvas-title" id="sidebarMenuLabel">
        Menú de Navegación
      </h5>
      <button
        type="button"
        class="btn-close btn-close-white"
        aria-label="Close"
        (click)="openMenu()"
      ></button>
    </div>

    <div class="offcanvas-body p-0">
      <div class="list-group list-group-flush">

        <a class="list-group-item list-group-item-action py-3"
           (click)="navigate('/home')">
          <i class="bi bi-house-door-fill me-2 text-success"></i>
          Inicio
        </a>

        <ng-container *ngIf="authService.hasAnyRole(['Radicador'])">
          <a class="list-group-item list-group-item-action py-3"
             (click)="navigate('/form')">
            <i class="bi bi-file-earmark-plus me-2 text-success"></i>
            Crear Anteproyecto
          </a>
        </ng-container>

        <ng-container *ngIf="authService.hasAnyRole(['Radicador','Metodos','Gerente','Vicepresidente','Administrador','Visitante'])">
          <a class="list-group-item list-group-item-action py-3"
             (click)="navigate('/history')">
            <i class="bi bi-journal-text me-2 text-warning"></i>
            Historial de Radicación
          </a>
        </ng-container>

        <ng-container *ngIf="authService.hasAnyRole(['Radicador','Metodos','Gerente','Vicepresidente'])">
          <a class="list-group-item list-group-item-action py-3"
             (click)="navigate('/calculator')">
            <i class="bi bi-calculator me-2 text-primary"></i>
            Calculadora
          </a>
        </ng-container>

        <ng-container *ngIf="authService.hasAnyRole(['Administrador'])">
          <a class="list-group-item list-group-item-action py-3"
             (click)="navigate('/usuario')">
            <i class="bi bi-people me-2 text-success"></i>
            Gestión de Usuarios
          </a>
          <a class="list-group-item list-group-item-action py-3"
             (click)="navigate('/info-form')">
            <i class="bi bi-gear-fill me-2 text-primary"></i>
            Configurar Formulario
          </a>
        </ng-container>

      </div>
    </div>

    <div class="offcanvas-footer p-3 border-top">
      <button class="btn btn-danger w-100" (click)="logout()">
        <i class="bi bi-box-arrow-right me-2"></i>
        Cerrar Sesión
      </button>
    </div>
  </div>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-success px-4 shadow-sm">
    <div class="container-fluid">

      <!-- BOTÓN MENÚ -->
      <button class="btn text-white me-3" (click)="openMenu()">
        <i class="bi bi-list fs-3"></i>
      </button>

      <!-- HOME -->
      <a class="navbar-brand d-flex align-items-center"
         (click)="navigate('/home')"
         style="cursor:pointer">
        <i class="bi bi-house-door-fill fs-4"></i>
      </a>

      <!-- USUARIO / DROPDOWN ANGULAR -->
      <div class="ms-auto position-relative">

        <button
          class="btn text-white d-flex align-items-center"
          (click)="toggleUserMenu()"
        >
          <i class="bi bi-person-circle fs-4"></i>
        </button>

        <ul
          *ngIf="showUserMenu"
          class="dropdown-menu dropdown-menu-end shadow show"
          style="right:0; left:auto;"
        >
          <li class="dropdown-header">
            <strong>{{ user?.name }}</strong><br>
            <small class="text-muted">{{ user?.email }}</small><br>
            <small class="text-muted">{{ user?.role }}</small>
          </li>
          <li><hr class="dropdown-divider"></li>
          <li>
            <button class="dropdown-item text-danger"
                    (click)="logout()">
              <i class="bi bi-box-arrow-right me-2"></i>
              Cerrar sesión
            </button>
          </li>
        </ul>

      </div>

    </div>
  </nav>

</div>

<router-outlet></router-outlet>


<router-outlet></router-outlet>

</body>
</html>